# Mochizuki_Takamasa_internProject01

## ğŸ§¾ èª²é¡Œâ‘ ï¼šFlask Ã— SQLite Ã— Renderï¼ˆåŸºæœ¬æ§‹æˆï¼‰
ğŸ¯ èª²é¡Œæ¦‚è¦
Flaskã‚’ç”¨ã„ãŸç°¡æ˜“çš„ãªWebã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã—
SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®è‡ªå‹•ç”Ÿæˆã¨Renderç’°å¢ƒã§ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®Ÿç¾ã—ã¾ã—ãŸã€‚
å­¦æ ¡å‘ã‘ã€Œé€£çµ¡å¸³ã‚·ã‚¹ãƒ†ãƒ ï¼ˆPoCç‰ˆï¼‰ã€ã§ã™ã€‚  
ç”Ÿå¾’ãƒ»æ‹…ä»»ãƒ»ç®¡ç†è€…ã®3ãƒ­ãƒ¼ãƒ«ã§é€£æºã—ã€  
å¹³æ—¥ã®ã¿è¨˜éŒ²ã‚’æå‡ºãƒ»ç¢ºèªã§ãã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ç™ºã—ã¾ã™ã€‚

ğŸ§© ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæƒ…å ±
é …ç›®	å†…å®¹
é–‹ç™ºè€…	TAKAMASA MOCHIZUKI
ç’°å¢ƒ	Python 3.11 / Flask
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹	SQLiteï¼ˆdiary.dbï¼‰
ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒ	Renderï¼ˆFree Tierï¼‰
ãƒªãƒã‚¸ãƒˆãƒªç®¡ç†	GitLab
å‹•ä½œç¢ºèªæ—¥	2025/10/09

Mochizuki_Takamasa_internProject01/
â”œâ”€ app.py                # Flaskã‚¢ãƒ—ãƒªæœ¬ä½“
â”œâ”€ requirements.txt      # ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å®šç¾©
â”œâ”€ runtime.txt           # Pythonãƒ©ãƒ³ã‚¿ã‚¤ãƒ æŒ‡å®š
â”œâ”€ Procfile              # Renderãƒ‡ãƒ—ãƒ­ã‚¤ç”¨è¨­å®š
â””â”€ README.md             # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦


---
##ğŸ§© ãƒªãƒã‚¸ãƒˆãƒªæ§‹æˆ
#school-contactbook/
â”œâ”€ frontend/                # React (TypeScript)
â”‚  â”œâ”€ public/
â”‚  â”œâ”€ src/
â”‚  â”‚  â”œâ”€ components/
â”‚  â”‚  â”œâ”€ pages/
â”‚  â”‚  â”‚  â”œâ”€ Login.tsx
â”‚  â”‚  â”‚  â””â”€ ContactList.tsx
â”‚  â”‚  â”œâ”€ api/
â”‚  â”‚  â””â”€ index.tsx
â”‚  â”œâ”€ package.json
â”‚  â””â”€ tsconfig.json
â”‚
â”œâ”€ backend/                 # Django REST Framework
â”‚  â”œâ”€ contacts/             # é€£çµ¡å¸³ã‚¢ãƒ—ãƒª
â”‚  â”œâ”€ users/                # èªè¨¼ãƒ»æ¨©é™ç®¡ç†
â”‚  â”œâ”€ config/               # è¨­å®š
â”‚  â”œâ”€ requirements.txt
â”‚  â””â”€ manage.py
â”‚
â”œâ”€ infra/                   # Dockerãƒ»CIè¨­å®š
â”‚  â”œâ”€ Dockerfile.frontend
â”‚  â”œâ”€ Dockerfile.backend
â”‚  â””â”€ docker-compose.yml
â”‚
â”œâ”€ .gitlab-ci.yml           # GitLab CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
â”œâ”€ README.md
â””â”€ LICENSE


---
##âš™ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
##åŒºåˆ†	ä½¿ç”¨æŠ€è¡“
##ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰	React + TypeScript + Tailwind CSS
##ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰	Django + Django REST Framework
##ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹	PostgreSQL
##èªè¨¼æ–¹å¼	JWTï¼ˆJSON Web Tokenï¼‰
##CI/CD	GitLab CI + Docker
##ä¼‘æ—¥åˆ¤å®š	jpholidayï¼ˆæ—¥æœ¬ã®ç¥æ—¥åˆ¤å®šãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰

##ğŸ§© Django ãƒ¢ãƒ‡ãƒ«ä¾‹
from django.contrib.auth.models import AbstractUser
from django.db import models
import jpholiday
from django.core.exceptions import ValidationError

ğŸ“¦ ä½¿ç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆrequirements.txtï¼‰
Flask
Flask-SQLAlchemy
Flask-Login
Flask-Bcrypt


class User(AbstractUser):
    ROLE_CHOICES = (
        ("student", "ç”Ÿå¾’"),
        ("teacher", "æ‹…ä»»"),
        ("admin", "ç®¡ç†è€…"),
    )
    role = models.CharField(max_length=20, choices=ROLE_CHOICES, default="student")
    assigned_class = models.CharField(max_length=16, blank=True, null=True)
    grade = models.CharField(max_length=16, blank=True, null=True)


class ContactEntry(models.Model):
    student = models.ForeignKey(User, on_delete=models.CASCADE, related_name="entries")
    date = models.DateField(auto_now_add=True)
    content = models.TextField()
    condition = models.CharField(max_length=64, blank=True)
    liked = models.BooleanField(default=False)
    read_by_teacher = models.BooleanField(default=False)
    created_at = models.DateTimeField(auto_now_add=True)

    def clean(self):
        # åœŸæ—¥ç¥æ—¥ã¯æå‡ºä¸å¯
        if self.date.weekday() >= 5 or jpholiday.is_holiday(self.date):
            raise ValidationError("åœŸæ—¥ç¥æ—¥ã¯æå‡ºã§ãã¾ã›ã‚“")

##ğŸ§© React ãƒšãƒ¼ã‚¸ä¾‹
import { useEffect, useState } from "react";

interface ContactEntry {
  id: number;
  student_name: string;
  date: string;
  content: string;
  condition: string;
  liked: boolean;
  read_by_teacher: boolean;
}

export default function ContactList() {
  const [entries, setEntries] = useState<ContactEntry[]>([]);

  useEffect(() => {
    fetch("/api/contactentries/")
      .then(res => res.json())
      .then(data => setEntries(data));
  }, []);

  return (
    <div className="p-4">
      <h1 className="text-2xl mb-4">é€£çµ¡å¸³ä¸€è¦§</h1>
      <table className="w-full border">
        <thead>
          <tr className="bg-gray-200">
            <th className="p-2 border">æ—¥ä»˜</th>
            <th className="p-2 border">ç”Ÿå¾’å</th>
            <th className="p-2 border">å†…å®¹</th>
            <th className="p-2 border">çŠ¶æ…‹</th>
            <th className="p-2 border">ğŸ‘</th>
            <th className="p-2 border">æ—¢èª­</th>
          </tr>
        </thead>
        <tbody>
          {entries.map(e => (
            <tr key={e.id}>
              <td className="border p-2">{e.date}</td>
              <td className="border p-2">{e.student_name}</td>
              <td className="border p-2">{e.content}</td>
              <td className="border p-2">{e.condition}</td>
              <td className="border p-2">{e.liked ? "ğŸ‘" : ""}</td>
              <td className="border p-2">{e.read_by_teacher ? "âœ…" : ""}</td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  );
}
##ğŸ§ª CI/CD è¨­å®šï¼ˆ.gitlab-ci.ymlï¼‰
stages:
  - lint
  - test
  - build
  - deploy

variables:
  REGISTRY: registry.gitlab.com/<USERNAME>/<PROJECT>
  FRONTEND_IMAGE: $REGISTRY/frontend
  BACKEND_IMAGE: $REGISTRY/backend

lint_backend:
  stage: lint
  image: python:3.11
  script:
    - cd backend
    - pip install -r requirements.txt
    - flake8

test_backend:
  stage: test
  image: python:3.11
  script:
    - cd backend
    - pip install -r requirements.txt
    - pytest

build_and_push:
  stage: build
  image: docker:24
  services:
    - docker:dind
  script:
    - docker build -t $FRONTEND_IMAGE:$CI_COMMIT_SHA -f infra/Dockerfile.frontend .
    - docker build -t $BACKEND_IMAGE:$CI_COMMIT_SHA -f infra/Dockerfile.backend .
    - docker push $FRONTEND_IMAGE:$CI_COMMIT_SHA
    - docker push $BACKEND_IMAGE:$CI_COMMIT_SHA
  only:
    - main

##ğŸ§­ é–‹ç™ºãƒ«ãƒ¼ãƒ«ãƒ»å—ã‘å…¥ã‚ŒåŸºæº–
##ç”Ÿå¾’ãŒè‡ªåˆ†ã®è¨˜éŒ²ã ã‘é–²è¦§ãƒ»æå‡ºã§ãã‚‹ï¼ˆå¹³æ—¥ã®ã¿ï¼‰
##æ‹…ä»»ãŒæ‹…å½“ã‚¯ãƒ©ã‚¹ã®æå‡ºçŠ¶æ³ã‚’ç¢ºèªã§ãã‚‹
##æ‹…ä»»ãŒæ—¢èª­å‡¦ç†ã‚’è¡Œãˆã‚‹
##ç®¡ç†è€…ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆãƒ»ã‚¯ãƒ©ã‚¹å‰²å½“ã§ãã‚‹
##CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã“ã¨

ğŸ“Š ãƒ†ã‚¹ãƒˆç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ

- å­¦ç”Ÿç”¨: ID = test_student / PW = 1234
- æ‹…ä»»ç”¨: ID = teacher / PW = abcd


ğŸ ã¾ã¨ã‚

æœ¬èª²é¡Œã§ã¯ã€

Flaskã§ã®Webã‚¢ãƒ—ãƒªæ§‹ç¯‰

SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®è‡ªå‹•ç”Ÿæˆ

GitLabé€£æºã¨Renderãƒ‡ãƒ—ãƒ­ã‚¤

ã‚’é€šã˜ã¦ã€åŸºæœ¬çš„ãªWebã‚¢ãƒ—ãƒªé–‹ç™ºã®æµã‚Œã‚’ç†è§£ã—ã¾ã—ãŸã€‚
